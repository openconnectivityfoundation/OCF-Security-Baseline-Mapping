<!doctype html>

<!--
table selection:
http://stackoverflow.com/questions/36880849/select-a-row-highlight-from-html-table-and-send-values-onclick-of-a-button
-->

<head>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap-theme.min.css"
    integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"
    integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd"
    crossorigin="anonymous"></script>


  <title>OCF Security Baseline mapping summary</title>
  <a href="https://openconnectivity.org/"><img src="OCF_POS_4C.png" alt="OCF Logo" width="300" height="64"
      align="right"></a>

</head>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">

<script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>

<script src="https://cdn.rawgit.com/ashl1/datatables-rowsgroup/v1.0.0/dataTables.rowsGroup.js"></script>
<script src="https://cdn.datatables.net/plug-ins/1.10.20/sorting/natural.js"></script>

<div class=page>

  <h1>OCF Security Baseline mapping overview </h1>

  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item">
      <a class="nav-link " href="index.html">Baseline Overview</a>
      <a class="nav-link active" href="summary.html">Baseline Summary</a>
    </li>
  </ul>


  <table border="1" id="example" class="display" width="100%" cellspacing="0" data-page-length='20'
    style="border-color:#D5D8DC">
    <thead>
      <tr>
        <th>Baseline Name </th>
        <th>Baseline Organization </th>
        <th>Baseline Items</th>
        <th>Baseline Sub Items</th>
        <th>Baseline Compliance</th>
      </tr>
    </thead>
  </table>

  <script>
    $('#example').DataTable({
      "ajax": {
        "url": "https://raw.githubusercontent.com/openconnectivityfoundation/OCF-Security-Baseline-Mapping/master/baseline-data.json",
        "dataSrc": function (json) {
          var return_data = new Array();
          var my_baselineName = " ";
          var my_baselineOrg = " ";
          var my_baselineURL = " ";
          var my_categoryName = " ";
          var my_subcategoryName = " ";
          var my_subcategoryNumber = " ";
          var my_specName = " ";
          var my_specURL = " ";
          var my_Clause = " ";
          var my_Notes = " ";
          var my_nr_items = 0;
          var my_nr_sub_items = 0;
          var my_nr_items_compliant = 0;
          var my_tot_nr_items = 0;
          var my_tot_nr_sub_items = 0;
          var my_tot_nr_items_compliant = 0;

          for (var i = 0; i < json.baseLines.length; i++) {
            // assign var in this loop
            my_nr_items = 0;
            my_nr_sub_items = 0;
            my_nr_items_compliant = 0;

            my_baselineName = json.baseLines[i].baselineName
            my_baselineOrg = json.baseLines[i].baselineOrg
            if (typeof json.baseLines[i].baselineURL != "undefined") {
              my_baselineURL = json.baseLines[i].baselineURL;
              my_baselineName = "<a href='" + my_baselineURL + "'>" + my_baselineName + "</a>"
            }
            for (var j = 0; j < json.baseLines[i].baselineCategories.length; j++) {
              // assign vars in this loop
              my_categoryName = json.baseLines[i].baselineCategories[j].categoryNumber + ".\r\n" + json.baseLines[i].baselineCategories[j].categoryName
              for (var k = 0; k < json.baseLines[i].baselineCategories[j].subCategories.length; k++) {
                var my_specName = " ";
                var my_specURL = " ";
                // assign vars in this loop
                if (typeof json.baseLines[i].baselineCategories[j].subCategories[k].subCategoryDescription != "undefined") {
                  my_subcategoryName = json.baseLines[i].baselineCategories[j].subCategories[k].subCategoryDescription
                }
                if (typeof json.baseLines[i].baselineCategories[j].subCategories[k].subCategoryNumber != "undefined") {
                  my_subcategoryNumber = json.baseLines[i].baselineCategories[j].subCategories[k].subCategoryNumber
                  my_subcategoryName = my_subcategoryNumber + ". " + my_subcategoryName;

                }
                if (typeof json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatchSpecification != "undefined") {
                  my_specName = json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatchSpecification
                }
                if (typeof json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatchSpecificationURL != "undefined") {
                  my_specURL = json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatchSpecificationURL
                  my_specName = "<a href='" + my_specURL + "'>" + my_specName + "</a>"
                }
                var my_Clause = " ";
                var my_Notes = " ";
                my_nr_items++
                

                for (var l = 0; l < json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatches.length; l++) {
                  // assign vars in this loop and create the table entry 
                  if (typeof json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatches[l].ocfMatchClause != "undefined") {
                    my_Clause = json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatches[l].ocfMatchClause
                  }
                  if (typeof json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatches[l].ocfMatchNotes != "undefined") {
                    my_Notes = json.baseLines[i].baselineCategories[j].subCategories[k].ocfMatches[l].ocfMatchNotes
                    var n = my_Notes.includes("Not Applicable");
                    if (n == false) {
                      my_nr_items_compliant++
                      my_tot_nr_items_compliant++
                    }
                    my_nr_sub_items++;
                    my_tot_nr_sub_items++;
                  }
                }
              }

            }
            console.log(my_baselineOrg + my_baselineName + my_nr_items + my_nr_items_compliant);
            return_data.push({
              'a': my_baselineOrg,
              'b': my_baselineName,
              'c': my_nr_items,
              'd': my_nr_sub_items,
              'e': my_nr_items_compliant
            })
          }
          return_data.push({
              'a': " ",
              'b': " Total",
              'c': my_tot_nr_items,
              'd': my_tot_nr_sub_items,
              'e': my_tot_nr_items_compliant
            })

          return return_data;
        }
      },
      "columns": [
        { "data": "a" },
        { "data": "b" },
        { "data": "c" },
        { "data": "d" },
        { "data": "e" }
      ]
    })
  </script>
</div>